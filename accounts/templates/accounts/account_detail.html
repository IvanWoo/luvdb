{% extends "base.html" %}
{% load static %}
{% load account_tags %}
{% load util_filters %}
{% load markdownify %}
{% load linkify %}

{% block title %}{{ object.display_name|default:object.username }}{% endblock %}
{% block content %}
    <div class="container">
        <div class="row justify-content-start">
            {% if is_blocked %}
                <div class="bg-black p-5 ps-3">
                    <p class="text-white">You are blocked by {{ object.display_name|default:object.username }} and cannot view the profile.</p>
                </div>
            {% elif not object.is_active %}
                <div class="bg-black p-5 ps-3">
                    <p class="text-white">This account has been deactivated at {{object.deactivated_at|date:"Y.m.d H:i"}}</p>
                </div>
            {% else %}
                <!--For small screen-->
                <!-- navbar -->
                <div class="col-12 d-block d-md-none mb-1">
                    <div class="row">
                        <div class="d-flex flex-wrap justify-content-start">
                            <span class="me-3">
                                <a href="{% url 'write:say_list' object.username %}">Says</a>
                            </span>
                            <span class="me-3">
                                <a href="{% url 'write:post_list' object.username %}">Posts</a>
                            </span>
                            <span class="me-3">
                                <a href="{% url 'write:pin_list' object.username %}">Pins</a>
                            </span>
                            <span class="me-3">
                                <a href="{% url 'write:album_list' object.username %}">Albums</a>
                            </span>
                            <span class="me-3">
                                <a href="{% url 'write:luvlist_list' object.username %}">Lists</a>
                            </span>
                            {% if object.username == user.username %}
                                <span class="me-3">
                                    <a href="{% url 'accounts:liked' object.username %}">Liked</a>
                                </span>
                                <span class="me-3">
                                    <a href="{% url 'write:replied' object.username %}">Replied</a>
                                </span>
                            {% endif %}
                        </div>
                    </div>
                    <hr>
                </div>
                <!-- bio -->
                <div class="col-12 d-block d-md-none mb-1">
                    <div class="bio p-3 bg-light">
                        <div class="align-items-center">
                            {% if object.display_name %}
                                <span class="me-1">
                                    {{ object.display_name }}
                                </span>
                            {% endif %}
                            <a href="{% url 'accounts:detail' object.username %}" class="me-1">
                                @{{ object.username }}
                            </a>
                            {% if not object.privacy_level != "public" %}
                                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" title="This profile is not public" aria-label="This profile is not public">
                                    <path d="M 12 1 C 8.6761905 1 6 3.6761905 6 7 L 6 8 C 4.9 8 4 8.9 4 10 L 4 20 C 4 21.1 4.9 22 6 22 L 18 22 C 19.1 22 20 21.1 20 20 L 20 10 C 20 8.9 19.1 8 18 8 L 18 7 C 18 3.6761905 15.32381 1 12 1 z M 12 3 C 14.27619 3 16 4.7238095 16 7 L 16 8 L 8 8 L 8 7 C 8 4.7238095 9.7238095 3 12 3 z M 12 13 C 13.1 13 14 13.9 14 15 C 14 16.1 13.1 17 12 17 C 10.9 17 10 16.1 10 15 C 10 13.9 10.9 13 12 13 z"></path>
                                </svg>
                            {% endif %}
                        </div>
                        <div class="mb-3">
                            {% if living_in %}
                                <span class="text-muted">Based in</span>
                                <a href="{% url 'visit:location_detail' living_in.0.content_object.id %}">
                                    {{ living_in.0.content_object.name }}
                                </a>
                            {% endif %}
                            <div class="text-muted">Joined {{ object.date_joined|daysince }} days ago</div>
                        </div>
                        {% if object.bio %}
                            <div>{{ object.bio | linkify_tags | markdownify }}</div>
                        {% endif %}
                        {% if object == request.user %}
                            <div class='d-flex'>
                                <!-- Action buttons -->
                                <a class="btn btn-primary btn-sm mt-3 me-1"
                                href="{% url 'accounts:update' object.username %}"
                                role="button">Update Profile</a>
                                <div class="dropdown mt-3">
                                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle"
                                            type="button"
                                            id="actionMenu"
                                            data-bs-toggle="dropdown"
                                            aria-expanded="false">More</button>
                                    <ul class="dropdown-menu" aria-labelledby="actionMenu">
                                        <li>
                                            <a class="dropdown-item"
                                            href="{% url 'accounts:manage_invitations' object.username %}"
                                            role="button">Invite friends</a>
                                        </li>
                                        {% if object.is_staff %}
                                        <li>
                                            <a class="dropdown-item"
                                                href="{% url 'manage_invitation_requests' %}"
                                                role="button">Manage Invite Requests</a>
                                        </li>
                                        {% endif %}
                                        <li>
                                            <a class="dropdown-item"
                                            href="{% url 'accounts:app_password' object.username %}"
                                            role="button">Manage App Passwords</a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item"
                                            href="{% url 'accounts:crossposters' object.username %}"
                                            role="button">Manage Crossposters</a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item"
                                            href="{% url 'accounts:export_user_data' object.username %}"
                                            role="button">Export Your Data</a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        {% endif %}
                        {% if object != request.user %}
                            <div class='d-flex'>
                                {% if not request.user|is_blocking:object %}
                                    {% if request.user|is_following:object %}
                                        <form method="POST" action="{% url 'activity_feed:unfollow' object.id %}">
                                            {% csrf_token %}
                                            <button class="btn btn-primary btn-sm mt-3 me-1" type="submit">Unfollow</button>
                                        </form>
                                    {% else %}
                                        <form method="POST" action="{% url 'activity_feed:follow' object.id %}">
                                            {% csrf_token %}
                                            <button class="btn btn-primary btn-sm mt-3 me-1" type="submit">Follow</button>
                                        </form>
                                    {% endif %}
                                {% endif %}
                                <div class="dropdown mt-3">
                                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle"
                                            type="button"
                                            id="actionMenu"
                                            data-bs-toggle="dropdown"
                                            aria-expanded="false">More</button>
                                    <ul class="dropdown-menu" aria-labelledby="actionMenu">
                                        {% if request.user|is_blocking:object %}
                                            <li>
                                                <form method="POST" action="{% url 'activity_feed:unblock' object.id %}">
                                                    {% csrf_token %}
                                                    <button class="dropdown-item" type="submit">Unblock</button>
                                                </form>
                                            </li>
                                        {% else %}
                                            <li>
                                                <form method="POST" action="{% url 'activity_feed:block' object.id %}">
                                                    {% csrf_token %}
                                                    <button class="dropdown-item" type="submit">Block</button>
                                                </form>
                                            </li>
                                        {% endif %}
                                    </ul>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    <hr>
                </div>

                <!-- recent -->
                <div class="col-12 d-block d-md-none mb-1 mobile-version">
                    <!--Most recent activity-->
                    <div class="d-flex justify-content-between align-items-center">
                        <div class="fs-5">Recent</div>
                        <a class="btn btn-outline-secondary btn-sm"
                        href="{% url 'accounts:feed' object.username %}">All</a>
                    </div>
                    {% for activity in recent_activities %}
                        {% include "activity_feed/activity_item.html" %}
                        <hr>
                    {% endfor %}
                </div>

                <!-- records -->
                <div class="col-12 d-block d-md-none mb-2">
                    {% if does_read_exist %}
                        <div class="row">
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <div class="fs-4">Read</div>
                                <div>
                                    <a class="btn btn-outline-secondary btn-sm"
                                    href="{% url 'write:read_checkin_user_list' object.username %}">All</a>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                {% if reading %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Reading</div>
                                        {% for item in reading %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                            {% if item.content_type.model == 'book' %}
                                                    <a href="{% url 'write:book_checkin_list' item.user.username item.content_object.id %}">
                                                        {% if user.pure_text_mode %}
                                                            <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                    </a>
                                                {% elif item.content_type.model == 'issue' %}
                                                    <a href="{% url 'write:issue_checkin_list' item.user.username item.content_object.periodical.id item.content_object.id %}">
                                                        {% if user.pure_text_mode %}
                                                            <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                    </a>
                                                {% endif %}
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if read %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Read</div>
                                        {% for item in read %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                {% if item.content_type.model == 'book' %}
                                                    <a href="{% url 'write:book_checkin_list' item.user.username item.content_object.id  %}">
                                                        <div class="position-relative">
                                                            {% if user.pure_text_mode %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% else %}
                                                                {% if item.content_object.cover %}
                                                                    {% if item.content_object.cover_sens %}
                                                                        <img src="{{ item.content_object.cover.url }}"
                                                                                alt="{{ item.content_object.title }} cover"
                                                                                class="img-fluid blur cover-border"
                                                                                onclick="this.classList.toggle('blur')"
                                                                                loading="lazy">
                                                                    {% else %}
                                                                        <img src="{{ item.content_object.cover.url }}"
                                                                                alt="{{ item.content_object.title }}"
                                                                                class="img-fluid cover-border"
                                                                                onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                                loading="lazy">
                                                                    {% endif %}
                                                                {% else %}
                                                                    <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                                {% endif %}
                                                            {% endif %}
                                                            {% if item.has_voted %}
                                                                <div class="position-absolute bottom-0 start-0 m-1">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                        <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                    </svg>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    </a>
                                                    {% elif item.content_type.model == 'issue' %}
                                                    <a href="{% url 'write:issue_checkin_list' item.user.username item.content_object.periodical.id item.content_object.id %}">
                                                        <div class="position-relative">
                                                            {% if user.pure_text_mode %}
                                                                <div class="cover-placeholder bg-light">{{ item.periodical.title }} Vol. {{ item.volume }} Nr. {{ item.number }}</div>
                                                            {% else %}
                                                                {% if item.content_object.cover %}
                                                                    {% if item.cover_sens %}
                                                                        <img src="{{ item.content_object.cover.url }}"
                                                                                alt="{{ item.title }} cover"
                                                                                class="img-fluid blur cover-border"
                                                                                onclick="this.classList.toggle('blur')"
                                                                                loading="lazy">
                                                                    {% else %}
                                                                        <img src="{{ item.content_object.cover.url }}"
                                                                                alt="{{ item.title }}"
                                                                                class="img-fluid cover-border"
                                                                                onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.periodical.title }} Vol. {{ item.content_object.volume }} Nr. {{ item.content_object.number }}</div>';"
                                                                                loading="lazy">
                                                                    {% endif %}
                                                                {% else %}
                                                                    <div class="cover-placeholder bg-light">{{ item.content_object.periodical.title }} Vol. {{ item.content_object.volume }} Nr. {{ issue.content_object.number }}</div>
                                                                {% endif %}
                                                            {% endif %}
                                                            {% if item.has_voted %}
                                                                <div class="position-absolute bottom-0 start-0 m-1">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                        <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                    </svg>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    </a>
                                                {% endif %}
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}
                    {% if does_watch_exist %}
                        <div class="row">
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <div class="mt-4 fs-4">Watch</div>
                                <div>
                                    <a class="btn btn-outline-secondary btn-sm"
                                    href="{% url 'write:watch_checkin_user_list' object.username %}">All</a>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                {% if watching %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Watching</div>
                                        {% for item in watching %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                {% if item.content_type.model == 'movie' %}
                                                    <a href="{% url 'write:movie_checkin_list' item.user.username item.content_object.id %}">
                                                        {% if user.pure_text_mode %}
                                                            <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.poster %}
                                                                {% if item.content_object.poster_sens %}
                                                                    <img src="{{ item.content_object.poster.url }}"
                                                                            alt="{{ item.content_object.title }} poster"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.poster.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                    </a>
                                                {% elif item.content_type.model == 'season' %}
                                                    <a href="{% url 'write:season_checkin_list' item.user.username item.content_object.series.id item.content_object.season_number %}">
                                                        {% if user.pure_text_mode %}
                                                            <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.poster %}
                                                                {% if item.content_object.poster_sens %}
                                                                    <img src="{{ item.content_object.poster.url }}"
                                                                            alt="{{ item.content_object.title }} poster"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.poster.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                    </a>
                                                {% endif %}
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if watched %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Watched</div>
                                        {% for item in watched %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                {% if item.content_type.model == 'movie' %}
                                                    <a href="{% url 'write:movie_checkin_list' item.user.username item.content_object.id %}">
                                                        <div class="position-relative">
                                                            {% if user.pure_text_mode %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% else %}
                                                                {% if item.content_object.poster %}
                                                                    {% if item.content_object.poster_sens %}
                                                                        <img src="{{ item.content_object.poster.url }}"
                                                                                alt="{{ item.content_object.title }} poster"
                                                                                class="img-fluid blur cover-border"
                                                                                onclick="this.classList.toggle('blur')"
                                                                                loading="lazy">
                                                                    {% else %}
                                                                        <img src="{{ item.content_object.poster.url }}"
                                                                                alt="{{ item.content_object.title }}"
                                                                                class="img-fluid cover-border bg-light"
                                                                                onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                                loading="lazy">
                                                                    {% endif %}
                                                                {% else %}
                                                                    <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                                {% endif %}
                                                            {% endif %}
                                                            {% if item.has_voted %}
                                                                <div class="position-absolute bottom-0 start-0 m-1">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                        <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                    </svg>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    </a>
                                                {% elif item.content_type.model == 'season' %}
                                                    <a href="{% url 'write:season_checkin_list' item.user.username item.content_object.series.id item.content_object.season_number %}">
                                                        <div class="position-relative">
                                                            {% if user.pure_text_mode %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% else %}
                                                                {% if item.content_object.poster %}
                                                                    {% if item.content_object.poster_sens %}
                                                                        <img src="{{ item.content_object.poster.url }}"
                                                                                alt="{{ item.content_object.title }} poster"
                                                                                class="img-fluid blur cover-border"
                                                                                onclick="this.classList.toggle('blur')"
                                                                                loading="lazy">
                                                                    {% else %}
                                                                        <img src="{{ item.content_object.poster.url }}"
                                                                                alt="{{ item.content_object.title }}"
                                                                                class="img-fluid cover-border"
                                                                                onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                                loading="lazy">
                                                                    {% endif %}
                                                                {% else %}
                                                                    <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                                {% endif %}
                                                            {% endif %}
                                                            {% if item.has_voted %}
                                                                <div class="position-absolute bottom-0 start-0 m-1">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                        <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                    </svg>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    </a>
                                                {% endif %}

                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}
                    {% if does_listen_exist %}
                        <div class="row">
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <div class="mt-4 fs-4">Listen</div>
                                <div>
                                    <a class="btn btn-outline-secondary btn-sm"
                                    href="{% url 'write:listen_checkin_user_list' object.username %}">All</a>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                {% if listening %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Listening</div>
                                        {% for item in listening %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-4 p-1">
                                                <a href="{% url 'write:audiobook_checkin_list' item.user.username item.content_object.id %}">
                                                    {% if user.pure_text_mode %}
                                                        <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                    {% else %}
                                                        {% if item.content_object.cover %}
                                                            {% if item.content_object.cover_sens %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }} cover"
                                                                        class="img-fluid blur cover-border"
                                                                        onclick="this.classList.toggle('blur')"
                                                                        loading="lazy">
                                                            {% else %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }}"
                                                                        class="img-fluid cover-border"
                                                                        onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'listen-cover-placeholder\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                        loading="lazy">
                                                            {% endif %}
                                                        {% else %}
                                                            <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% endif %}
                                                    {% endif %}
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if looping %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Looping</div>
                                        {% for item in looping %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                <a href="{% url 'write:release_checkin_list' item.user.username item.content_object.id %}">
                                                    {% if user.pure_text_mode %}
                                                        <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                    {% else %}
                                                        {% if item.content_object.cover %}
                                                            {% if item.content_object.cover_sens %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }} cover"
                                                                        class="img-fluid blur cover-border"
                                                                        onclick="this.classList.toggle('blur')"
                                                                        loading="lazy">
                                                            {% else %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }}"
                                                                        class="img-fluid cover-border"
                                                                        onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'listen-cover-placeholder\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                        loading="lazy">
                                                            {% endif %}
                                                        {% else %}
                                                            <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% endif %}
                                                    {% endif %}
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if listened %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Listend</div>
                                        {% for item in listened %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                            {% if item.content_object.model_name == "Release" %}
                                                <a href="{% url 'write:release_checkin_list' item.user.username item.content_object.id %}">
                                                    <div class="position-relative">
                                                        {% if user.pure_text_mode %}
                                                            <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border bg-light"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'listen-cover-placeholder\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% if item.has_voted %}
                                                            <div class="position-absolute bottom-0 start-0 m-1">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                    <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                </svg>
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                </a>
                                                {% elif item.content_object.model_name == "Audiobook" %}
                                                <a href="{% url 'write:audiobook_checkin_list' item.user.username item.content_object.id %}">
                                                    <div class="position-relative">
                                                        {% if user.pure_text_mode %}
                                                            <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border bg-light"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'listen-cover-placeholder\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% if item.has_voted %}
                                                            <div class="position-absolute bottom-0 start-0 m-1">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                    <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                </svg>
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                </a>
                                                {% endif %}
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if subscribed %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Subscribed</div>
                                        {% for item in subscribed %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                <a href="{% url 'write:podcast_checkin_list' item.user.username item.content_object.id %}">
                                                    <div class="position-relative">
                                                        {% if user.pure_text_mode %}
                                                            <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border bg-light"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'listen-cover-placeholder\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% if item.has_voted %}
                                                            <div class="position-absolute bottom-0 start-0 m-1">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                    <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                </svg>
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}
                    {% if does_play_exist %}
                        <div class="row">
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <div class="mt-4 fs-4">Play</div>
                                <div>
                                    <a class="btn btn-outline-secondary btn-sm"
                                    href="{% url 'write:play_checkin_user_list' object.username %}">All</a>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                {% if playing %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Playing</div>
                                        {% for item in playing %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                <a href="{% url 'write:play_checkin_list' item.user.username item.content_object.id %}">
                                                    {% if user.pure_text_mode %}
                                                        <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                    {% else %}
                                                        {% if item.content_object.cover %}
                                                            {% if item.content_object.cover_sens %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }} cover"
                                                                        class="img-fluid blur cover-border"
                                                                        onclick="this.classList.toggle('blur')"
                                                                        loading="lazy">
                                                            {% else %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }}"
                                                                        class="img-fluid cover-border bg-light"
                                                                        onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                        loading="lazy">
                                                            {% endif %}
                                                        {% else %}
                                                            <div class="cover-placeholder img-fluid bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% endif %}
                                                    {% endif %}
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if played %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Played</div>
                                        {% for item in played %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                <a href="{% url 'write:play_checkin_list' item.user.username item.content_object.id %}">
                                                    <div class="position-relative">
                                                        {% if user.pure_text_mode %}
                                                            <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur bg-light"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border bg-light"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="cover-placeholder img-fluid bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% if item.has_voted %}
                                                            <div class="position-absolute bottom-0 start-0 m-1">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                    <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                </svg>
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}

                    {% if does_visit_exist %}
                        <div class="row">
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <div class="mt-4 fs-4">Visit</div>
                                <div>
                                    <a class="btn btn-outline-secondary btn-sm"
                                    href="{% url 'write:visit_checkin_user_list' object.username %}">All</a>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                {% if visiting %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Visiting</div>
                                        {% for item in visiting %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                <a href="{% url 'write:play_checkin_list' item.user.username item.content_object.id %}">
                                                    {% if item.content_object.osm_id %}
                                                        <div class="mb-1 mb-md-0 flex-shrink-0">
                                                            <a href="{% url 'visit:location_detail' item.content_object.id %}" title="{{item.content_object.name}}">
                                                                {% with map_id=item.content_object.id|add:400 %}
                                                                    <div id="mapid-{{ map_id }}" style="height: 200px;"></div>
                                                                {% endwith %}
                                                            </a>
                                                            <script>
                                                                document.addEventListener('DOMContentLoaded', function() {
                                                                    setTimeout(function() {
                                                                        {% with map_id=item.content_object.id|add:400 %}
                                                                            initializeMap('mapid-{{ map_id }}', "{{ item.content_object.osm_id }}", "{{ item.content_object.osm_id_type }}", "{{item.content_object.level}}");
                                                                        {% endwith %}
                                                                    }, {{ forloop.counter0 }} * 1500); 
                                                                });
                                                            </script>
                                                        </div>                                                    
                                                    {% endif %}
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if played %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Visited</div>
                                        {% for item in visited %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                <a href="{% url 'write:play_checkin_list' item.user.username item.content_object.id %}">
                                                    {% if item.content_object.osm_id %}
                                                        <div class="mb-1 mb-md-0 flex-shrink-0">
                                                            <a href="{% url 'visit:location_detail' item.content_object.id %}" title="{{item.content_object.name}}">
                                                                {% with map_id=item.content_object.id|add:300 %}
                                                                    <div id="mapid-{{ map_id }}" style="height: 200px;"></div>
                                                                {% endwith %}
                                                            </a>
                                                            <script>
                                                                document.addEventListener('DOMContentLoaded', function() {
                                                                    setTimeout(function() {
                                                                        {% with map_id=item.content_object.id|add:300 %}
                                                                            initializeMap('mapid-{{ map_id }}', "{{ item.content_object.osm_id }}", "{{ item.content_object.osm_id_type }}", "{{item.content_object.level}}");
                                                                        {% endwith %}
                                                                    }, {{ forloop.counter0 }} * 1500); 
                                                                });
                                                            </script>
                                                        </div>                                                    
                                                    {% endif %}
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>                    
                    {% endif %}
                </div>

                {% if object == request.user %}
                    <!-- follow -->
                    <div class="col-12 d-block d-md-none mb-1">
                        <!-- For mobile screens, this block will be after the left column. For desktop screens, it will be in the right column. -->
                        <div>
                            <!--following-->
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="fs-4">Following</div>
                                <a class="btn btn-outline-secondary btn-sm"
                                href="{% url 'accounts:following_list' object.username %}">All</a>
                            </div>
                            {% for follow in recent_following %}
                                <span class="me-2"><a href="{% url 'accounts:detail' username=follow.followed.username %}">{{ follow.followed.display_name|default:follow.followed.username }}</a></span>
                            {% empty %}
                                <p>This user is not following anyone.</p>
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}

                <!-- For larger screens: keep the existing layout -->
                <!-- Left column -->
                <div class="col-md-8 col-sm-12 d-none d-md-block">
                    <!--navbar-->
                    <div class="row">
                        <div class="d-flex flex-wrap justify-content-start">
                            <span class="me-3">
                                <a href="{% url 'write:say_list' object.username %}">Says</a>
                            </span>
                            <span class="me-3">
                                <a href="{% url 'write:post_list' object.username %}">Posts</a>
                            </span>
                            <span class="me-3">
                                <a href="{% url 'write:pin_list' object.username %}">Pins</a>
                            </span>
                            <span class="me-3">
                                <a href="{% url 'write:album_list' object.username %}">Albums</a>
                            </span>
                            <span class="me-3">
                                <a href="{% url 'write:luvlist_list' object.username %}">Lists</a>
                            </span>
                            {% if object.username == user.username %}
                                <span class="me-3">
                                    <a href="{% url 'accounts:liked' object.username %}">Liked</a>
                                </span>
                                <span class="me-3">
                                    <a href="{% url 'write:replied' object.username %}">Replied</a>
                                </span>
                            {% endif %}
                        </div>
                    </div>
                    <hr>
                    {% if does_read_exist %}
                        <div class="row">
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <div class="fs-4">Read</div>
                                <div>
                                    <a class="btn btn-outline-secondary btn-sm"
                                    href="{% url 'write:read_checkin_user_list' object.username %}">All</a>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                {% if reading %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Reading</div>
                                        {% for item in reading %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                            {% if item.content_type.model == 'book' %}
                                                    <a href="{% url 'write:book_checkin_list' item.user.username item.content_object.id  %}">
                                                        {% if user.pure_text_mode %}
                                                            <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                    </a>
                                                {% elif item.content_type.model == 'issue' %}
                                                    <a href="{% url 'write:issue_checkin_list' item.user.username item.content_object.periodical.id item.content_object.id %}">
                                                        {% if user.pure_text_mode %}
                                                            <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                    </a>
                                                {% endif %}
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if read %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Read</div>
                                        {% for item in read %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                {% if item.content_type.model == 'book' %}
                                                    <a href="{% url 'write:book_checkin_list' item.user.username item.content_object.id  %}" >
                                                        <div class="position-relative">
                                                            {% if user.pure_text_mode %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% else %}
                                                                {% if item.content_object.cover %}
                                                                    {% if item.content_object.cover_sens %}
                                                                        <img src="{{ item.content_object.cover.url }}"
                                                                                alt="{{ item.content_object.title }} cover"
                                                                                class="img-fluid blur cover-border"
                                                                                onclick="this.classList.toggle('blur')"
                                                                                loading="lazy">
                                                                    {% else %}
                                                                        <img src="{{ item.content_object.cover.url }}"
                                                                                alt="{{ item.content_object.title }}"
                                                                                class="img-fluid cover-border"
                                                                                onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                                loading="lazy">
                                                                    {% endif %}
                                                                {% else %}
                                                                    <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                                {% endif %}
                                                            {% endif %}
                                                            {% if item.has_voted %}
                                                                <div class="position-absolute bottom-0 start-0 m-1">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                        <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                    </svg>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    </a>
                                                    {% elif item.content_type.model == 'issue' %}
                                                        <a href="{% url 'write:issue_checkin_list' item.user.username item.content_object.periodical.id item.content_object.id %}">
                                                            <div class="position-relative">
                                                                {% if user.pure_text_mode %}
                                                                    <div class="cover-placeholder bg-light">{{ item.periodical.title }} Vol. {{ item.volume }} Nr. {{ item.number }}</div>
                                                                {% else %}
                                                                    {% if item.content_object.cover %}
                                                                        {% if item.cover_sens %}
                                                                            <img src="{{ item.content_object.cover.url }}"
                                                                                    alt="{{ item.title }} cover"
                                                                                    class="img-fluid blur cover-border"
                                                                                    onclick="this.classList.toggle('blur')"
                                                                                    loading="lazy">
                                                                        {% else %}
                                                                            <img src="{{ item.content_object.cover.url }}"
                                                                                    alt="{{ item.title }}"
                                                                                    class="img-fluid cover-border"
                                                                                    onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.periodical.title }} Vol. {{ item.content_object.volume }} Nr. {{ item.content_object.number }}</div>';"
                                                                                    loading="lazy">
                                                                        {% endif %}
                                                                    {% else %}
                                                                        <div class="cover-placeholder bg-light">{{ item.content_object.periodical.title }} Vol. {{ item.content_object.volume }} Nr. {{ issue.content_object.number }}</div>
                                                                    {% endif %}
                                                                {% endif %}
                                                                {% if item.has_voted %}
                                                                    <div class="position-absolute bottom-0 start-0 m-1">
                                                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                            <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                        </svg>
                                                                    </div>
                                                                {% endif %}
                                                            </div>
                                                        </a>
                                                    {% endif %}
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}
                    {% if does_watch_exist %}
                        <div class="row">
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <div class="mt-4 fs-4">Watch</div>
                                <div>
                                    <a class="btn btn-outline-secondary btn-sm"
                                    href="{% url 'write:watch_checkin_user_list' object.username %}">All</a>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                {% if watching %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Watching</div>
                                        {% for item in watching %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                {% if item.content_type.model == 'movie' %}
                                                    <a href="{% url 'write:movie_checkin_list' item.user.username item.content_object.id %}">
                                                        {% if user.pure_text_mode %}
                                                            <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.poster %}
                                                                {% if item.content_object.poster_sens %}
                                                                    <img src="{{ item.content_object.poster.url }}"
                                                                            alt="{{ item.content_object.title }} poster"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.poster.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                    </a>
                                                {% elif item.content_type.model == 'season' %}
                                                    <a href="{% url 'write:season_checkin_list' item.user.username item.content_object.series.id item.content_object.season_number %}">
                                                        {% if user.pure_text_mode %}
                                                            <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.poster %}
                                                                {% if item.content_object.poster_sens %}
                                                                    <img src="{{ item.content_object.poster.url }}"
                                                                            alt="{{ item.content_object.title }} poster"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.poster.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                    </a>
                                                {% endif %}
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if watched %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Watched</div>
                                        {% for item in watched %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                {% if item.content_type.model == 'movie' %}
                                                    <a href="{% url 'write:movie_checkin_list' item.user.username item.content_object.id %}">
                                                        <div class="position-relative">
                                                            {% if user.pure_text_mode %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% else %}
                                                                {% if item.content_object.poster %}
                                                                    {% if item.content_object.poster_sens %}
                                                                        <img src="{{ item.content_object.poster.url }}"
                                                                                alt="{{ item.content_object.title }} poster"
                                                                                class="img-fluid blur cover-border"
                                                                                onclick="this.classList.toggle('blur')"
                                                                                loading="lazy">
                                                                    {% else %}
                                                                        <img src="{{ item.content_object.poster.url }}"
                                                                                alt="{{ item.content_object.title }}"
                                                                                class="img-fluid cover-border bg-light"
                                                                                onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                                loading="lazy">
                                                                    {% endif %}
                                                                {% else %}
                                                                    <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                                {% endif %}
                                                            {% endif %}
                                                            {% if item.has_voted %}
                                                                <div class="position-absolute bottom-0 start-0 m-1">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                        <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                    </svg>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    </a>
                                                {% elif item.content_type.model == 'season' %}
                                                    <a href="{% url 'write:season_checkin_list' item.user.username item.content_object.series.id item.content_object.season_number %}">
                                                        <div class="position-relative">
                                                            {% if user.pure_text_mode %}
                                                                <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% else %}
                                                                {% if item.content_object.poster %}
                                                                    {% if item.content_object.poster_sens %}
                                                                        <img src="{{ item.content_object.poster.url }}"
                                                                                alt="{{ item.content_object.title }} poster"
                                                                                class="img-fluid blur cover-border"
                                                                                onclick="this.classList.toggle('blur')"
                                                                                loading="lazy">
                                                                    {% else %}
                                                                        <img src="{{ item.content_object.poster.url }}"
                                                                                alt="{{ item.content_object.title }}"
                                                                                class="img-fluid cover-border"
                                                                                onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                                loading="lazy">
                                                                    {% endif %}
                                                                {% else %}
                                                                    <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                                {% endif %}
                                                            {% endif %}
                                                            {% if item.has_voted %}
                                                                <div class="position-absolute bottom-0 start-0 m-1">
                                                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                        <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                    </svg>
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    </a>
                                                {% endif %}
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}
                    {% if does_listen_exist %}
                        <div class="row">
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <div class="mt-4 fs-4">Listen</div>
                                <div>
                                    <a class="btn btn-outline-secondary btn-sm"
                                    href="{% url 'write:listen_checkin_user_list' object.username %}">All</a>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                {% if listening %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Listening</div>
                                        {% for item in listening %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-4 p-1">
                                                <a href="{% url 'write:audiobook_checkin_list' item.user.username item.content_object.id %}">
                                                    {% if user.pure_text_mode %}
                                                        <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                    {% else %}
                                                        {% if item.content_object.cover %}
                                                            {% if item.content_object.cover_sens %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }} cover"
                                                                        class="img-fluid blur cover-border"
                                                                        onclick="this.classList.toggle('blur')"
                                                                        loading="lazy">
                                                            {% else %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }}"
                                                                        class="img-fluid cover-border"
                                                                        onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'listen-cover-placeholder\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                        loading="lazy">
                                                            {% endif %}
                                                        {% else %}
                                                            <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% endif %}
                                                    {% endif %}
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if looping %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Looping</div>
                                        {% for item in looping %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                <a href="{% url 'write:release_checkin_list' item.user.username item.content_object.id %}">
                                                    {% if user.pure_text_mode %}
                                                        <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                    {% else %}
                                                        {% if item.content_object.cover %}
                                                            {% if item.content_object.cover_sens %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }} cover"
                                                                        class="img-fluid blur cover-border"
                                                                        onclick="this.classList.toggle('blur')"
                                                                        loading="lazy">
                                                            {% else %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }}"
                                                                        class="img-fluid cover-border"
                                                                        onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'listen-cover-placeholder\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                        loading="lazy">
                                                            {% endif %}
                                                        {% else %}
                                                            <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% endif %}
                                                    {% endif %}
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if listened %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Listend</div>
                                        {% for item in listened %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                            {% if item.content_object.model_name == "Release" %}
                                                <a href="{% url 'write:release_checkin_list' item.user.username item.content_object.id %}">
                                                    <div class="position-relative">
                                                        {% if user.pure_text_mode %}
                                                            <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border bg-light"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'listen-cover-placeholder\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% if item.has_voted %}
                                                            <div class="position-absolute bottom-0 start-0 m-1">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                    <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                </svg>
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                </a>
                                                {% elif item.content_object.model_name == "Audiobook" %}
                                                <a href="{% url 'write:audiobook_checkin_list' item.user.username item.content_object.id %}">
                                                    <div class="position-relative">
                                                        {% if user.pure_text_mode %}
                                                            <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border bg-light"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'listen-cover-placeholder\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% if item.has_voted %}
                                                            <div class="position-absolute bottom-0 start-0 m-1">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                    <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                </svg>
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                </a>
                                                {% endif %}
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if subscribed %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Subscribed</div>
                                        {% for item in subscribed %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                <a href="{% url 'write:podcast_checkin_list' item.user.username item.content_object.id %}">
                                                    <div class="position-relative">
                                                        {% if user.pure_text_mode %}
                                                            <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur cover-border"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border bg-light"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'listen-cover-placeholder\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="listen-cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% if item.has_voted %}
                                                            <div class="position-absolute bottom-0 start-0 m-1">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                    <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                </svg>
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}
                    {% if does_play_exist %}
                        <div class="row">
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <div class="mt-4 fs-4">Play</div>
                                <div>
                                    <a class="btn btn-outline-secondary btn-sm"
                                    href="{% url 'write:play_checkin_user_list' object.username %}">All</a>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                {% if playing %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Playing</div>
                                        {% for item in playing %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                <a href="{% url 'write:play_checkin_list' item.user.username item.content_object.id%}">
                                                    {% if user.pure_text_mode %}
                                                        <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                    {% else %}
                                                        {% if item.content_object.cover %}
                                                            {% if item.content_object.cover_sens %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }} cover"
                                                                        class="img-fluid blur cover-border"
                                                                        onclick="this.classList.toggle('blur')"
                                                                        loading="lazy">
                                                            {% else %}
                                                                <img src="{{ item.content_object.cover.url }}"
                                                                        alt="{{ item.content_object.title }}"
                                                                        class="img-fluid cover-border bg-light"
                                                                        onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                        loading="lazy">
                                                            {% endif %}
                                                        {% else %}
                                                            <div class="cover-placeholder img-fluid bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% endif %}
                                                    {% endif %}
                                                    {% if item.has_voted %}
                                                        <div class="position-absolute bottom-0 start-0 m-1">
                                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                            </svg>
                                                        </div>
                                                    {% endif %}
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if played %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Played</div>
                                        {% for item in played %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                <a href="{% url 'write:play_checkin_list' item.user.username item.content_object.id %}">
                                                    <div class="position-relative">
                                                        {% if user.pure_text_mode %}
                                                            <div class="cover-placeholder bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                        {% else %}
                                                            {% if item.content_object.cover %}
                                                                {% if item.content_object.cover_sens %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }} cover"
                                                                            class="img-fluid blur bg-light"
                                                                            onclick="this.classList.toggle('blur')"
                                                                            loading="lazy">
                                                                {% else %}
                                                                    <img src="{{ item.content_object.cover.url }}"
                                                                            alt="{{ item.content_object.title }}"
                                                                            class="img-fluid cover-border bg-light"
                                                                            onerror="this.onerror=null; this.parentNode.innerHTML='<div class=\'cover-placeholder bg-light\'>{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>';"
                                                                            loading="lazy">
                                                                {% endif %}
                                                            {% else %}
                                                                <div class="cover-placeholder img-fluid bg-light">{{ item.content_object.title }}{% if item.content_object.subtitle %}: {{item.content_object.subtitle}}{% endif %}</div>
                                                            {% endif %}
                                                        {% endif %}
                                                        {% if item.has_voted %}
                                                            <div class="position-absolute bottom-0 start-0 m-1">
                                                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="red" class="bi bi-heart-fill" viewBox="0 0 16 16">
                                                                    <path stroke="currentColor" stroke-width="0.3" fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"/>
                                                                </svg>
                                                            </div>
                                                        {% endif %}
                                                    </div>
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                        </div>
                    {% endif %}

                    {% if does_visit_exist %}
                        <div class="row">
                            <div class="d-flex justify-content-between align-items-center mt-2">
                                <div class="mt-4 fs-4">Visit</div>
                                <div>
                                    <a class="btn btn-outline-secondary btn-sm"
                                    href="{% url 'write:visit_checkin_user_list' object.username %}">All</a>
                                </div>
                            </div>
                            <div class="col-sm-12">
                                {% if visiting %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Visiting</div>
                                        {% for item in visiting %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2 ">
                                                <a href="{% url 'write:play_checkin_list' item.user.username item.content_object.id%}">
                                                    {% if item.content_object.osm_id %}
                                                        <div class="mb-1 mb-md-0 flex-shrink-0">
                                                            <a href="{% url 'visit:location_detail' item.content_object.id %}" title="{{item.content_object.name}}">
                                                                {% with map_id=item.content_object.id|add:200 %}
                                                                    <div id="mapid-{{ map_id }}" style="height: 200px;"></div>
                                                                {% endwith %}
                                                            </a>
                                                            <script>
                                                                document.addEventListener('DOMContentLoaded', function() {
                                                                    setTimeout(function() {
                                                                        {% with map_id=item.content_object.id|add:200 %}
                                                                            initializeMap('mapid-{{ map_id }}', "{{ item.content_object.osm_id }}", "{{ item.content_object.osm_id_type }}", "{{item.content_object.level}}");
                                                                        {% endwith %}
                                                                    }, {{ forloop.counter0 }} * 1500); 
                                                                });
                                                            </script>
                                                        </div>                                                    
                                                    {% endif %}
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                                {% if visited %}
                                    <div class="mt-3 me-3 d-flex overflow-auto">
                                        <div class="rotate text-muted">Visited</div>
                                        {% for item in visited %}
                                            <div class="col-3 col-sm-3 col-md-2 col-lg-2 mb-1 me-2">
                                                <a href="{% url 'write:visit_checkin_list' item.user.username item.content_object.id %}">
                                                    {% if item.content_object.osm_id %}
                                                        <div class="mb-1 mb-md-0 flex-shrink-0">
                                                            <a href="{% url 'visit:location_detail' item.content_object.id %}" title="{{item.content_object.name}}">
                                                                {% with map_id=item.content_object.id|add:100 %}
                                                                    <div id="mapid-{{ map_id }}" style="height: 200px;"></div>
                                                                {% endwith %}
                                                            </a>
                                                            <script>
                                                                document.addEventListener('DOMContentLoaded', function() {
                                                                    setTimeout(function() {
                                                                        {% with map_id=item.content_object.id|add:100 %}
                                                                            initializeMap('mapid-{{ map_id }}', "{{ item.content_object.osm_id }}", "{{ item.content_object.osm_id_type }}", "{{item.content_object.level}}");
                                                                        {% endwith %}
                                                                    }, {{ forloop.counter0 }} * 1500); 
                                                                });
                                                            </script>
                                                        </div>                                                    
                                                    {% endif %}
                                                </a>
                                            </div>
                                        {% empty %}
                                            <p>No items.</p>
                                        {% endfor %}
                                    </div>
                                {% endif %}
                            </div>
                            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.css" />
                            <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.min.js"></script>
                            <script src="https://cdn.jsdelivr.net/npm/osmtogeojson@3.0.0-beta.5/osmtogeojson.min.js"></script>
                            <script src="https://api.mapbox.com/mapbox.js/plugins/leaflet-image/v0.0.4/leaflet-image.js"></script>
                            <script src="{% static 'js/osm.js' %}"></script>
                        </div>                    
                    {% endif %}
                </div>
                <!-- Right column -->
                <div class="col-md-4 col-sm-12 d-none d-md-block">
                    <div class="bio p-3 bg-light">
                        <div class="d-flex flex-wrap align-items-center">
                            {% if object.display_name %}
                                <span class="me-1">
                                    {{ object.display_name }}
                                </span>
                            {% endif %}
                            <a href="{% url 'accounts:detail' object.username %}" class="h-card me-1" rel="me">
                                @{{ object.username }}
                            </a>
                            {% if object.privacy_level != "public" %}
                                <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" title="This profile is not public" aria-label="This profile is not public">
                                    <path d="M 12 1 C 8.6761905 1 6 3.6761905 6 7 L 6 8 C 4.9 8 4 8.9 4 10 L 4 20 C 4 21.1 4.9 22 6 22 L 18 22 C 19.1 22 20 21.1 20 20 L 20 10 C 20 8.9 19.1 8 18 8 L 18 7 C 18 3.6761905 15.32381 1 12 1 z M 12 3 C 14.27619 3 16 4.7238095 16 7 L 16 8 L 8 8 L 8 7 C 8 4.7238095 9.7238095 3 12 3 z M 12 13 C 13.1 13 14 13.9 14 15 C 14 16.1 13.1 17 12 17 C 10.9 17 10 16.1 10 15 C 10 13.9 10.9 13 12 13 z"></path>
                                </svg>
                            {% endif %}
                        </div>
                        <div class="mb-3">
                            {% if living_in %}
                                <span class="text-muted">Based in</span>
                                <a href="{% url 'visit:location_detail' living_in.0.content_object.id %}">
                                    {{ living_in.0.content_object.name }}
                                </a>
                            {% endif %}
                            <div class="text-muted">Joined {{ object.date_joined|daysince }} days ago</div>
                        </div>
                        {% if object.bio %}
                            <div>{{ object.bio | linkify_tags | markdownify }}</div>
                        {% endif %}
                        {% if object == request.user %}
                            <div class='d-flex '>
                                <!-- Action buttons -->
                                <a class="btn btn-primary btn-sm mt-3 me-1"
                                href="{% url 'accounts:update' object.username %}"
                                role="button">Update Profile</a>
                                <div class="dropdown mt-3">
                                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle"
                                            type="button"
                                            id="actionMenu"
                                            data-bs-toggle="dropdown"
                                            aria-expanded="false">More</button>
                                    <ul class="dropdown-menu" aria-labelledby="actionMenu">
                                        <li>
                                            <a class="dropdown-item"
                                                href="{% url 'accounts:manage_invitations' object.username %}"
                                                role="button">Invite Friends</a>
                                        </li>
                                        {% if object.is_staff %}
                                        <li>
                                            <a class="dropdown-item"
                                                href="{% url 'manage_invitation_requests' %}"
                                                role="button">Manage Invite Requests</a>
                                        </li>
                                        {% endif %}
                                        <li>
                                            <a class="dropdown-item"
                                            href="{% url 'accounts:app_password' object.username %}"
                                            role="button">Manage App Passwords</a>
                                        </li>
                                        <li>
                                            <a class="dropdown-item"
                                            href="{% url 'accounts:crossposters' object.username %}"
                                            role="button">Manage Cross-posters</a>
                                        </li>  
                                        <li>
                                            <a class="dropdown-item"
                                            href="{% url 'accounts:export_user_data' object.username %}"
                                            role="button">Export Data</a>
                                        </li>                                    
                                    </ul>
                                </div>
                            </div>
                        {% endif %}
                        {% if object != request.user %}
                            <div class='d-flex'>
                                {% if not request.user|is_blocking:object %}
                                    {% if request.user|is_following:object %}
                                        <form method="POST" action="{% url 'activity_feed:unfollow' object.id %}">
                                            {% csrf_token %}
                                            <button class="btn btn-primary btn-sm mt-3 me-1" type="submit">Unfollow</button>
                                        </form>
                                    {% else %}
                                        <form method="POST" action="{% url 'activity_feed:follow' object.id %}">
                                            {% csrf_token %}
                                            <button class="btn btn-primary btn-sm mt-3 me-1" type="submit">Follow</button>
                                        </form>
                                    {% endif %}
                                {% endif %}
                                <div class="dropdown mt-3">
                                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle"
                                            type="button"
                                            id="actionMenu"
                                            data-bs-toggle="dropdown"
                                            aria-expanded="false">More</button>
                                    <ul class="dropdown-menu" aria-labelledby="actionMenu">
                                        {% if request.user|is_blocking:object %}
                                            <li>
                                                <form method="POST" action="{% url 'activity_feed:unblock' object.id %}">
                                                    {% csrf_token %}
                                                    <button class="dropdown-item" type="submit">Unblock</button>
                                                </form>
                                            </li>
                                        {% else %}
                                            <li>
                                                <form method="POST" action="{% url 'activity_feed:block' object.id %}">
                                                    {% csrf_token %}
                                                    <button class="dropdown-item" type="submit">Block</button>
                                                </form>
                                            </li>
                                        {% endif %}
                                    </ul>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                    <hr>
                    <!-- recent -->
                    <div class="desktop-version">
                        <!--Most recent activity-->
                        <div class="d-flex justify-content-between align-items-center">
                            <div class="fs-5">Recent</div>
                            <a class="btn btn-outline-secondary btn-sm"
                            href="{% url 'accounts:feed' object.username %}">All</a>
                        </div>
                        {% for activity in recent_activities %}
                            {% include "activity_feed/activity_item.html" with width='narrow' %}
                        {% endfor %}
                    </div>
                    {% if object == request.user %}
                    <!-- Following and Followers -->
                    <div class="col-12 order-3 order-md-2 mb-3">
                        <!-- For mobile screens, this block will be after the left column. For desktop screens, it will be in the right column. -->
                        <div>
                            <!--following-->
                            <div class="d-flex justify-content-between align-items-center">
                                <div class="fs-5">Following</div>
                                <a class="btn btn-outline-secondary btn-sm"
                                href="{% url 'accounts:following_list' object.username %}">All</a>
                            </div>
                            {% for follow in recent_following %}
                                <span class="me-2"><a href="{% url 'accounts:detail' username=follow.followed.username %}">{{ follow.followed.display_name|default:follow.followed.username }}</a></span>
                            {% empty %}
                                <p>This user is not following anyone.</p>
                            {% endfor %}
                        </div>
                    </div>
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
    {% include 'mathjax+mermaid.html' %}
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            updateTabSetIds('.mobile-version .tabbed-set', '-mobile');
            updateTabSetIds('.desktop-version .tabbed-set', '-desktop');
            updateMapIds('.mobile-version .map-container', '-mobile');
            updateMapIds('.desktop-version .map-container', '-desktop');
        });
    
        function updateTabSetIds(selector, suffix) {
            var tabSets = document.querySelectorAll(selector);
    
            tabSets.forEach(function(tabSet, setIndex) {
                var inputs = tabSet.querySelectorAll('input[type="radio"]');
                var labels = tabSet.querySelectorAll('label');
    
                for (var i = 0; i < inputs.length; i++) {
                    var baseId = inputs[i].id || 'tab';
                    var newId = baseId + '-set' + setIndex + '-input' + i + suffix;
    
                    // console.log('Updating ID from:', inputs[i].id, 'to:', newId); // Debugging log
                    inputs[i].id = newId;
    
                    if (i < labels.length) {
                        // console.log('Updating label for from:', labels[i].getAttribute('for'), 'to:', newId); // Debugging log
                        labels[i].setAttribute('for', newId);
                    }
                }
            });
        }
        function updateMapIds(selector, suffix) {
            var mapContainers = document.querySelectorAll(selector);
            mapContainers.forEach(function(container, index) {
                var baseId = container.id || 'mapid';
                var newId = baseId + suffix;
        
                // console.log('Updating map container ID from:', container.id, 'to:', newId); // Debugging log
                container.id = newId;
        
                // Re-initialize map with new ID
                if (container.getAttribute('data-osm-id')) {
                    initializeMap(newId, container.getAttribute('data-osm-id'));
                }
            });
        }
    </script>     
    <style>
    .rotate {
        writing-mode: vertical-rl;
        transform: rotate(180deg);
        text-align: center;
        margin-top: 0; 
        margin-bottom: 0;
        margin-left: 0;
        margin-right: 0.25em;
    }
    .cover-image-2 {
        max-width: 120px;
        width: 95%;
        height: auto;
    }
    </style>
{% endblock content %}
